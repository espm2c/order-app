# 커피 주문 앱 PRD

## 목차
1. [주문하기 화면](#주문하기-화면)
2. [관리자 화면](#관리자-화면)

---

# 주문하기 화면

## 1. 화면 개요

### 1.1 화면명
주문하기 화면

### 1.2 화면 목적
사용자가 커피 메뉴를 선택하고 장바구니에 담아 주문할 수 있는 메인 화면입니다.

### 1.3 화면 구성
- 헤더 영역
- 메뉴 아이템 영역
- 장바구니 영역

---

## 2. 화면 구성 요소

### 2.1 헤더 영역

#### 2.1.1 로고
- **위치**: 화면 좌측 상단
- **디자인**: 
  - 다크 그린 배경의 직사각형 박스
  - 내부에 "COZY" 텍스트 (흰색)
- **크기**: 적절한 로고 영역 크기

#### 2.1.2 네비게이션 버튼
- **위치**: 헤더 우측
- **버튼 구성**:
  - **주문하기 버튼**: 현재 화면이므로 활성화 상태 표시
  - **관리자 버튼**: 관리자 화면으로 이동하는 버튼
- **동작**: 버튼 클릭 시 해당 화면으로 이동

---

### 2.2 메뉴 아이템 영역

#### 2.2.1 레이아웃
- 메뉴 아이템들이 카드 형태로 가로로 배치
- 가로 스크롤 또는 그리드 레이아웃

#### 2.2.2 메뉴 카드 구성 요소

각 메뉴 카드는 다음 요소를 포함합니다:

1. **이미지 영역**
   - 위치: 카드 상단
   - 디자인: 
     - 흰색 배경의 직사각형 박스
     - 대각선 교차선이 있는 플레이스홀더 (이미지가 없는 경우)
     - 또는 실제 메뉴 이미지
   - 크기: 적절한 이미지 비율 유지

2. **메뉴명**
   - 위치: 이미지 하단
   - 형식: 텍스트
   - 예시: "아메리카노(ICE)", "아메리카노(HOT)", "카페라떼"
   - 스타일: 명확하고 읽기 쉬운 폰트

3. **가격**
   - 위치: 메뉴명 하단 또는 옆
   - 형식: 원화 표기
   - 예시: "4,000원", "5,000원"
   - 표시: 천 단위 구분 기호(쉼표) 사용

4. **설명**
   - 위치: 가격 하단
   - 형식: 간단한 설명 텍스트
   - 예시: "간단한 설명..."
   - 스타일: 작은 폰트, 회색 계열

5. **커스터마이징 옵션**
   - 위치: 설명 하단
   - 형식: 체크박스 형태의 옵션들
   - 옵션 구성:
     - **샷 추가**: +500원
     - **시럽 추가**: +0원
   - 동작:
     - 옵션 선택 시 체크박스 활성화
     - 다중 선택 가능
     - 옵션 선택 시 가격 실시간 반영 (옵션 가격 합계 표시)

6. **담기 버튼**
   - 위치: 카드 하단
   - 디자인: 회색 배경 버튼
   - 텍스트: "담기"
   - 동작: 클릭 시 선택한 옵션과 함께 장바구니에 추가

#### 2.2.3 메뉴 카드 예시

**아메리카노(ICE)**
- 가격: 4,000원
- 설명: 간단한 설명...
- 옵션: 샷 추가 (+500원), 시럽 추가 (+0원)

**아메리카노(HOT)**
- 가격: 4,000원
- 설명: 간단한 설명...
- 옵션: 샷 추가 (+500원), 시럽 추가 (+0원)

**카페라떼**
- 가격: 5,000원
- 설명: 간단한 설명...
- 옵션: 샷 추가 (+500원), 시럽 추가 (+0원)

---

### 2.3 장바구니 영역

#### 2.3.1 위치 및 레이아웃
- 화면 하단에 고정된 영역
- 또는 스크롤 가능한 영역

#### 2.3.2 장바구니 제목
- 텍스트: "장바구니"
- 위치: 장바구니 영역 상단

#### 2.3.3 장바구니 아이템 목록

각 장바구니 아이템은 다음 정보를 표시:

- **아이템 정보**:
  - 메뉴명
  - 선택한 옵션 (있는 경우): 괄호 안에 표시
  - 수량: "X 수량" 형식
  - 가격: 개별 아이템의 총 가격 (메뉴 가격 + 옵션 가격)

- **표시 형식**: 
  - "메뉴명 (옵션) X 수량" - "가격원"
  - 예시: 
    - "아메리카노(ICE) (샷 추가) X 1" - "4,500원"
    - "아메리카노(HOT) X 2" - "8,000원"

- **레이아웃**: 
  - 각 아이템은 한 줄에 표시
  - 메뉴명과 수량은 좌측, 가격은 우측 정렬

#### 2.3.4 총 금액
- **위치**: 장바구니 아이템 목록 우측 또는 하단
- **레이블**: "총 금액"
- **금액**: 모든 장바구니 아이템의 (개별 가격 × 수량) 합계
- **표시**: 굵은 글씨로 강조
- **예시**: "총 금액 12,500원"

#### 2.3.5 주문하기 버튼
- **위치**: 총 금액 하단 또는 장바구니 영역 하단
- **디자인**: 회색 배경 버튼
- **텍스트**: "주문하기"
- **동작**: 클릭 시 주문 처리

---

## 3. 기능 요구사항

### 3.1 메뉴 표시
- 서버에서 메뉴 목록을 조회하여 화면에 표시
- 각 메뉴는 카드 형태로 가로 스크롤 또는 그리드 레이아웃으로 배치
- 메뉴 이미지가 없는 경우 플레이스홀더 이미지 표시

### 3.2 커스터마이징 옵션
- 각 메뉴 카드에서 옵션을 선택할 수 있음
- 옵션 선택 시 가격이 실시간으로 반영되어야 함 (옵션 가격 합계 표시)
- 옵션은 다중 선택 가능
- 옵션 미선택 시 기본 가격으로 표시

### 3.3 장바구니 기능
- "담기" 버튼 클릭 시 선택한 옵션과 함께 장바구니에 추가
- 같은 메뉴와 옵션 조합이 이미 장바구니에 있으면 수량 증가
- 장바구니 아이템 목록에 다음 정보 표시:
  - 메뉴명
  - 선택한 옵션 (있는 경우)
  - 수량
  - 개별 가격 (메뉴 가격 + 옵션 가격)
- 장바구니에 아이템이 추가되면 총 금액이 자동으로 업데이트
- 총 금액은 모든 장바구니 아이템의 (개별 가격 × 수량) 합계

### 3.4 주문하기 기능
- "주문하기" 버튼 클릭 시:
  - 장바구니에 아이템이 있는지 확인
  - 주문 데이터를 서버로 전송
  - 주문 성공 시 장바구니 초기화 및 성공 메시지 표시
  - 주문 실패 시 에러 메시지 표시

### 3.5 화면 이동
- "관리자" 버튼 클릭 시 관리자 화면으로 이동

---

## 4. UI/UX 요구사항

### 4.1 디자인
- 전체적으로 깔끔하고 미니멀한 디자인
- 배경: 흰색
- 텍스트: 다크 그레이
- 강조 색상: 다크 그린 (로고 영역)
- 버튼: 회색 배경
- 활성화된 버튼: 명확한 시각적 구분

### 4.2 레이아웃
- 반응형 디자인 고려 (모바일/태블릿/데스크톱)
- 메뉴 카드는 가로 스크롤 또는 그리드 레이아웃
- 장바구니는 화면 하단에 고정 또는 스크롤 가능한 영역

### 4.3 사용자 경험
- 버튼 클릭 시 시각적 피드백 제공 (호버 효과 등)
- 장바구니에 아이템 추가 시 시각적 피드백 (애니메이션 등)
- 옵션 선택 시 가격 변경이 즉시 반영되어야 함
- 장바구니가 비어있을 때 적절한 안내 메시지 표시

---

## 5. 데이터 구조

### 5.1 메뉴 데이터
```javascript
{
  id: number,
  name: string,
  price: number,
  description: string,
  imageUrl: string | null,
  options: [
    {
      id: number,
      name: string,
      price: number
    }
  ]
}
```

### 5.2 장바구니 아이템 데이터
```javascript
{
  menuId: number,
  menuName: string,
  basePrice: number,
  selectedOptions: [
    {
      optionId: number,
      optionName: string,
      optionPrice: number
    }
  ],
  quantity: number,
  totalPrice: number // (basePrice + sum of optionPrices) * quantity
}
```

### 5.3 주문 데이터
```javascript
{
  items: [
    {
      menuId: number,
      menuName: string,
      options: [
        {
          optionId: number,
          optionName: string
        }
      ],
      quantity: number,
      price: number
    }
  ],
  totalAmount: number
}
```

---

## 6. 상세 기능 명세

### 6.1 가격 계산 로직

#### 6.1.1 메뉴 카드의 현재 가격 표시
```
현재 가격 = 메뉴 기본 가격 + 선택한 옵션들의 가격 합계
```

예시:
- 아메리카노(ICE): 4,000원
- 샷 추가 선택: +500원
- 시럽 추가 선택: +0원
- **표시 가격: 4,500원**

#### 6.1.2 장바구니 아이템 가격 계산
```
개별 아이템 가격 = 메뉴 기본 가격 + 선택한 옵션들의 가격 합계
아이템 총 가격 = 개별 아이템 가격 × 수량
```

예시:
- 아메리카노(ICE) + 샷 추가: 4,000 + 500 = 4,500원
- 수량 1개: 4,500 × 1 = 4,500원

#### 6.1.3 장바구니 총 금액 계산
```
총 금액 = 모든 장바구니 아이템의 (개별 가격 × 수량) 합계
```

예시:
- 아이템 1: 4,500원 (수량 1) = 4,500원
- 아이템 2: 4,000원 (수량 2) = 8,000원
- **총 금액: 12,500원**

### 6.2 장바구니 아이템 관리

#### 6.2.1 아이템 추가
- "담기" 버튼 클릭 시:
  1. 선택한 옵션 확인
  2. 메뉴 ID와 옵션 ID 조합으로 고유 키 생성
  3. 장바구니에 동일한 키가 있는지 확인
  4. 있으면 수량 증가, 없으면 새로 추가

#### 6.2.2 아이템 수량 관리
- 같은 메뉴와 옵션 조합이 이미 있으면 수량만 증가
- 수량 증가 시 총 가격도 자동 업데이트

### 6.3 주문 처리 흐름

1. 사용자가 "주문하기" 버튼 클릭
2. 장바구니에 아이템이 있는지 확인
   - 없으면: "장바구니가 비어있습니다." 메시지 표시
   - 있으면: 다음 단계 진행
3. 주문 데이터 구성
   - 장바구니의 모든 아이템을 주문 형식으로 변환
   - 총 금액 계산
4. 서버로 주문 데이터 전송
5. 응답 처리
   - 성공: 장바구니 초기화, 성공 메시지 표시
   - 실패: 에러 메시지 표시, 장바구니 유지

---

## 7. 예외 처리

### 7.1 장바구니가 비어있을 때
- "장바구니가 비어있습니다." 메시지 표시
- 주문하기 버튼 비활성화 또는 클릭 시 안내 메시지

### 7.2 네트워크 오류
- 서버 연결 실패 시 명확한 에러 메시지 표시
- 재시도 옵션 제공 (선택사항)

### 7.3 주문 실패
- 서버에서 반환한 에러 메시지 표시
- 장바구니 데이터 유지하여 재시도 가능하도록 함

---

## 8. 향후 개선 사항 (선택사항)

### 8.1 장바구니 기능 확장
- 장바구니에서 아이템 삭제 기능
- 장바구니에서 수량 직접 조절 기능
- 장바구니 아이템 수정 기능

### 8.2 사용자 경험 개선
- 주문 완료 시 Toast 알림 또는 모달 표시
- 장바구니 아이템 추가 시 애니메이션 효과
- 로딩 상태 표시

### 8.3 접근성 개선
- 키보드 네비게이션 지원
- 스크린 리더 지원
- ARIA 레이블 추가

---

## 9. 참고 사항

### 9.1 화면 전환
- 주문하기 화면과 관리자 화면 간 전환은 클라이언트 사이드 라우팅으로 처리
- 페이지 새로고침 없이 부드러운 전환

### 9.2 데이터 영속성
- 장바구니 데이터는 세션 동안 유지
- 페이지 새로고침 시 장바구니 초기화 (또는 localStorage 활용 가능)

### 9.3 성능 고려사항
- 메뉴 목록은 서버에서 한 번만 조회
- 가격 계산은 클라이언트 사이드에서 처리
- 불필요한 리렌더링 방지

---

# 관리자 화면

## 1. 화면 개요

### 1.1 화면명
관리자 화면

### 1.2 화면 목적
관리자가 주문을 관리하고 재고를 조회/수정할 수 있는 관리자 전용 화면입니다.

### 1.3 화면 구성
- 헤더 영역
- 관리자 대시보드 영역
- 재고 현황 영역
- 주문 현황 영역

---

## 2. 화면 구성 요소

### 2.1 헤더 영역

#### 2.1.1 로고
- **위치**: 화면 좌측 상단
- **디자인**: 
  - 다크 그린 배경의 직사각형 박스
  - 내부에 "COZY" 텍스트 (흰색)
- **크기**: 주문하기 화면과 동일

#### 2.1.2 네비게이션 버튼
- **위치**: 헤더 우측
- **버튼 구성**:
  - **주문하기 버튼**: 주문하기 화면으로 이동하는 버튼
  - **관리자 버튼**: 현재 화면이므로 활성화 상태 표시 (다크 테두리 등으로 구분)
- **동작**: 버튼 클릭 시 해당 화면으로 이동

---

### 2.2 관리자 대시보드 영역

#### 2.2.1 제목
- **텍스트**: "관리자 대시보드"
- **위치**: 대시보드 영역 상단

#### 2.2.2 주문 통계
- **위치**: 제목 하단
- **표시 형식**: 통계 정보를 카드 형태 또는 인라인으로 표시
- **통계 항목**:
  - **총 주문**: 모든 주문의 총 개수
  - **주문 접수**: "주문 접수" 상태인 주문 수
  - **제조 중**: "제조 중" 상태인 주문 수
  - **제조 완료**: "제조 완료" 상태인 주문 수
- **표시 형식 예시**: 
  - "총 주문 X / 주문 접수 Y / 제조 중 Z / 제조 완료 W"
  - 또는 각각을 별도 카드로 표시

---

### 2.3 재고 현황 영역

#### 2.3.1 제목
- **텍스트**: "재고 현황"
- **위치**: 재고 현황 영역 상단

#### 2.3.2 재고 카드
- **레이아웃**: 각 메뉴 아이템별로 카드 형태로 표시
- **배치**: 가로로 배치 (그리드 레이아웃)

각 재고 카드는 다음 요소를 포함:

1. **메뉴명**
   - 위치: 카드 상단 또는 중앙
   - 형식: 텍스트
   - 예시: "아메리카노 (ICE)", "아메리카노 (HOT)", "카페라떼"
   - 스타일: 명확하고 읽기 쉬운 폰트

2. **재고 수량**
   - 위치: 메뉴명 하단
   - 형식: 숫자 + "개"
   - 예시: "10개"
   - 스타일: 명확하게 표시

3. **재고 조절 버튼**
   - 위치: 재고 수량 옆 또는 하단
   - 버튼 구성:
     - **감소 버튼 (-)**: 재고 수량을 1 감소시키는 작은 버튼
     - **증가 버튼 (+)**: 재고 수량을 1 증가시키는 작은 버튼
   - 디자인: 작은 원형 또는 사각형 버튼
   - 동작:
     - 증가 버튼: 클릭 시 재고 +1
     - 감소 버튼: 클릭 시 재고 -1 (0 미만으로 내려가지 않도록 제한)
   - 피드백: 버튼 클릭 시 즉시 화면에 반영

---

### 2.4 주문 현황 영역

#### 2.4.1 제목
- **텍스트**: "주문 현황"
- **위치**: 주문 현황 영역 상단

#### 2.4.2 주문 목록
- **레이아웃**: 각 주문을 카드 형태로 세로로 배치
- **정렬**: 최신 주문이 위에 오도록 정렬 (시간 내림차순)
- **스크롤**: 주문이 많을 경우 세로 스크롤 가능

#### 2.4.3 주문 카드 구성 요소

각 주문 카드는 다음 요소를 포함:

1. **주문 시간**
   - 위치: 카드 상단 또는 헤더 영역
   - 형식: 날짜 및 시간
   - 예시: "7월 31일 13:00"
   - 표시: 명확하게 읽기 쉬운 형식

2. **주문 내용**
   - 위치: 주문 시간 하단
   - 형식: 메뉴명과 수량 목록
   - 예시: "아메리카노(ICE) x 1"
   - 표시: 각 메뉴 항목을 한 줄씩 표시
   - 옵션 표시: 선택한 옵션이 있으면 함께 표시
     - 예시: "아메리카노(ICE) (샷 추가) x 1"

3. **주문 금액**
   - 위치: 주문 내용 하단 또는 우측
   - 형식: 원화 표기
   - 예시: "4,000원"
   - 표시: 천 단위 구분 기호 사용

4. **주문 상태**
   - 위치: 카드 헤더 또는 하단
   - 상태 종류:
     - **대기**: 주문이 접수되기 전 상태
     - **주문 접수**: 접수되었지만 제조 전 상태
     - **제조 중**: 현재 제조 중인 상태
     - **제조 완료**: 제조가 완료된 상태
   - 표시: 상태 배지 또는 텍스트로 표시

5. **주문 상태 변경 버튼**
   - 위치: 카드 하단 또는 우측
   - 버튼 종류:
     - **주문 접수 버튼**: "대기" 상태일 때 표시, 클릭 시 "주문 접수" 상태로 변경
     - **제조 시작 버튼**: "주문 접수" 상태일 때 표시, 클릭 시 "제조 중" 상태로 변경
     - **제조 완료 버튼**: "제조 중" 상태일 때 표시, 클릭 시 "제조 완료" 상태로 변경
   - 디자인: 회색 배경 버튼
   - 동작: 클릭 시 주문 상태 업데이트 및 화면 새로고침

---

## 3. 기능 요구사항

### 3.1 대시보드 통계
- 서버에서 주문 통계를 조회하여 실시간으로 표시
- 주문 상태별로 카운트하여 표시:
  - 총 주문: 모든 주문의 총 개수
  - 주문 접수: "주문 접수" 상태인 주문 수
  - 제조 중: "제조 중" 상태인 주문 수
  - 제조 완료: "제조 완료" 상태인 주문 수
- 주문 상태가 변경되면 통계가 자동으로 업데이트

### 3.2 재고 관리
- 서버에서 각 메뉴 아이템의 현재 재고 수량을 조회하여 표시
- **재고 증가**: "+" 버튼 클릭 시:
  - 해당 메뉴의 재고 수량을 1 증가
  - 서버에 재고 수정 요청 전송
  - 성공 시 화면에 즉시 반영
  - 실패 시 에러 메시지 표시
- **재고 감소**: "-" 버튼 클릭 시:
  - 해당 메뉴의 재고 수량을 1 감소
  - 재고가 0 미만으로 내려가지 않도록 검증
  - 서버에 재고 수정 요청 전송
  - 성공 시 화면에 즉시 반영
  - 실패 시 에러 메시지 표시

### 3.3 주문 현황 관리
- 서버에서 주문 목록을 조회하여 표시
- 주문 목록에는 다음 상태의 주문들이 표시:
  - "대기" 상태: 주문이 접수되기 전 상태
  - "주문 접수" 상태: 접수되었지만 제조 전 상태
  - "제조 중" 상태: 현재 제조 중인 상태
  - "제조 완료" 상태: 제조가 완료된 상태
- 주문 목록은 최신 주문이 위에 오도록 정렬
- 각 주문 카드에 다음 정보 표시:
  - 주문 시간 (날짜 및 시간)
  - 주문한 메뉴와 수량
  - 주문 총액
- **주문 접수**: "주문 접수" 버튼 클릭 시:
  - 해당 주문의 상태를 "주문 접수"로 변경
  - 서버에 주문 상태 업데이트 요청 전송
  - 성공 시 주문 상태 변경 및 대시보드 통계 업데이트
  - 실패 시 에러 메시지 표시
- **제조 시작**: "제조 시작" 버튼 클릭 시:
  - 해당 주문의 상태를 "제조 중"으로 변경
  - 서버에 주문 상태 업데이트 요청 전송
  - 성공 시 주문 상태 변경 및 대시보드 통계 업데이트
  - 실패 시 에러 메시지 표시
- **제조 완료**: "제조 완료" 버튼 클릭 시:
  - 해당 주문의 상태를 "제조 완료"로 변경
  - 서버에 주문 상태 업데이트 요청 전송
  - 성공 시 주문 상태 변경 및 대시보드 통계 업데이트
  - 실패 시 에러 메시지 표시
- 주문 상태 변경 시 주문 목록이 자동으로 업데이트

### 3.4 화면 이동
- "주문하기" 버튼 클릭 시 주문하기 화면으로 이동

### 3.5 실시간 업데이트 (선택사항)
- 주문이 새로 접수되면 주문 현황 목록에 자동으로 추가
- 주문 상태가 변경되면 대시보드 통계가 자동으로 업데이트
- (구현 방식: 폴링 또는 WebSocket)

---

## 4. UI/UX 요구사항

### 4.1 디자인
- 주문하기 화면과 일관된 디자인 스타일 유지
- 전체적으로 깔끔하고 미니멀한 디자인
- 배경: 흰색
- 텍스트: 다크 그레이
- 강조 색상: 다크 그린 (로고 영역)
- 버튼: 회색 배경
- 활성화된 버튼: 다크 테두리로 표시

### 4.2 레이아웃
- 반응형 디자인 고려 (모바일/태블릿/데스크톱)
- 대시보드, 재고 현황, 주문 현황 섹션을 세로로 배치
- 재고 카드는 가로로 배치 (그리드 레이아웃)
- 주문 목록은 세로로 스크롤 가능한 형태

### 4.3 사용자 경험
- 버튼 클릭 시 시각적 피드백 제공 (호버 효과 등)
- 재고 수량 변경 시 즉시 화면에 반영
- 주문 상태 변경 시 명확한 시각적 피드백
- 주문이 없을 때 적절한 안내 메시지 표시
- 재고가 부족할 때 경고 표시 (선택사항)

---

## 5. 데이터 구조

### 5.1 대시보드 통계 데이터
```javascript
{
  totalOrders: number,
  receivedOrders: number,
  inProductionOrders: number,
  completedOrders: number
}
```

### 5.2 재고 데이터
```javascript
{
  menuId: number,
  menuName: string,
  stock: number
}
```

### 5.3 주문 현황 데이터
```javascript
{
  id: number,
  orderTime: string, // ISO 8601 형식 또는 타임스탬프
  items: [
    {
      menuId: number,
      menuName: string,
      options: [
        {
          optionId: number,
          optionName: string
        }
      ],
      quantity: number,
      price: number
    }
  ],
  totalAmount: number,
  status: 'pending' | 'received' | 'in_production' | 'completed'
}
```

### 5.4 재고 수정 요청 데이터
```javascript
{
  menuId: number,
  stockChange: number // +1 또는 -1
}
```

### 5.5 주문 상태 변경 요청 데이터
```javascript
{
  orderId: number,
  status: 'received' | 'in_production' | 'completed'
}
```

---

## 6. 상세 기능 명세

### 6.1 주문 상태 전이 규칙

#### 6.1.1 상태 전이 흐름
```
대기 → 주문 접수 → 제조 중 → 제조 완료
```

#### 6.1.2 상태 전이 규칙
- **대기 → 주문 접수**: 가능
- **주문 접수 → 제조 중**: 가능
- **제조 중 → 제조 완료**: 가능
- **제조 완료 → 다른 상태**: 불가능 (최종 상태)
- **역방향 전이**: 불가능 (예: 제조 중 → 주문 접수)

#### 6.1.3 버튼 표시 규칙
- **대기 상태**: "주문 접수" 버튼만 표시
- **주문 접수 상태**: "제조 시작" 버튼만 표시
- **제조 중 상태**: "제조 완료" 버튼만 표시
- **제조 완료 상태**: 버튼 없음 (최종 상태)

### 6.2 재고 관리 로직

#### 6.2.1 재고 증가
1. 사용자가 "+" 버튼 클릭
2. 현재 재고 수량 확인
3. 서버에 재고 +1 요청 전송
4. 성공 시 화면 업데이트
5. 실패 시 에러 메시지 표시

#### 6.2.2 재고 감소
1. 사용자가 "-" 버튼 클릭
2. 현재 재고 수량 확인
3. 재고가 0보다 큰지 확인
   - 0 이하면: 감소 불가 메시지 표시
   - 0보다 크면: 다음 단계 진행
4. 서버에 재고 -1 요청 전송
5. 성공 시 화면 업데이트
6. 실패 시 에러 메시지 표시

### 6.3 주문 목록 정렬
- 주문 시간 기준 내림차순 정렬 (최신 주문이 위에)
- 정렬 기준: `orderTime DESC`

### 6.4 통계 업데이트
- 주문 상태가 변경될 때마다 통계 재계산
- 서버에서 최신 통계 데이터 조회
- 화면에 즉시 반영

---

## 7. 예외 처리

### 7.1 주문이 없을 때
- "주문이 없습니다." 메시지 표시
- 빈 상태를 명확하게 표시

### 7.2 재고 조절 실패
- 재고가 0 미만이 될 경우: "재고가 0 미만이 될 수 없습니다." 메시지
- 서버 오류: 서버에서 반환한 에러 메시지 표시

### 7.3 주문 상태 변경 실패
- 유효하지 않은 상태 전이: "유효하지 않은 상태 전이입니다." 메시지
- 서버 오류: 서버에서 반환한 에러 메시지 표시

### 7.4 네트워크 오류
- 서버 연결 실패 시 명확한 에러 메시지 표시
- 재시도 옵션 제공 (선택사항)

---

## 8. 향후 개선 사항 (선택사항)

### 8.1 실시간 업데이트
- WebSocket을 사용한 실시간 주문 알림
- 주문이 새로 접수되면 자동으로 목록에 추가
- 주문 상태 변경 시 실시간 반영

### 8.2 필터링 및 검색
- 주문 상태별 필터링 기능
- 날짜별 주문 조회 기능
- 주문 검색 기능

### 8.3 통계 확장
- 일별/주별/월별 주문 통계
- 인기 메뉴 통계
- 매출 통계

### 8.4 재고 관리 개선
- 재고 수량 직접 입력 기능
- 재고 부족 알림 기능
- 재고 히스토리 조회

---

## 9. 참고 사항

### 9.1 화면 전환
- 관리자 화면과 주문하기 화면 간 전환은 클라이언트 사이드 라우팅으로 처리
- 페이지 새로고침 없이 부드러운 전환

### 9.2 데이터 새로고침
- 화면 진입 시 최신 데이터 조회
- 주문 상태 변경 후 데이터 자동 새로고침
- 주기적 데이터 새로고침 (선택사항)

### 9.3 성능 고려사항
- 주문 목록이 많을 경우 페이징 처리 고려
- 통계 계산은 서버에서 처리
- 불필요한 리렌더링 방지

---

# 백엔드 개발 PRD

## 목차
1. [데이터 모델](#데이터-모델)
2. [데이터 스키마를 위한 사용자 흐름](#데이터-스키마를-위한-사용자-흐름)
3. [API 설계](#api-설계)

---

## 데이터 모델

### 1. Menus (메뉴)

메뉴 정보를 저장하는 테이블입니다.

#### 필드
- **id** (Primary Key): 메뉴 고유 식별자
- **name** (String): 커피 이름 (예: "아메리카노(ICE)", "카페라떼")
- **description** (Text): 메뉴 설명
- **price** (Integer): 가격 (원 단위)
- **image_url** (String, Optional): 이미지 URL
- **stock** (Integer): 재고 수량 (기본값: 0)
- **created_at** (Timestamp): 생성 일시
- **updated_at** (Timestamp): 수정 일시

#### 제약 조건
- `price >= 0`: 가격은 0 이상이어야 함
- `stock >= 0`: 재고는 0 이상이어야 함
- `name`은 고유해야 함 (UNIQUE)

### 2. Options (옵션)

메뉴에 추가할 수 있는 옵션 정보를 저장하는 테이블입니다.

#### 필드
- **id** (Primary Key): 옵션 고유 식별자
- **name** (String): 옵션 이름 (예: "샷 추가", "시럽 추가")
- **price** (Integer): 옵션 가격 (원 단위, 0 이상)
- **menu_id** (Foreign Key): 연결된 메뉴 ID (Menus 테이블 참조)
- **created_at** (Timestamp): 생성 일시
- **updated_at** (Timestamp): 수정 일시

#### 제약 조건
- `price >= 0`: 옵션 가격은 0 이상이어야 함
- `menu_id`는 Menus 테이블의 유효한 ID여야 함
- 메뉴가 삭제되면 연결된 옵션도 함께 삭제됨 (CASCADE)

### 3. Orders (주문)

주문 정보를 저장하는 테이블입니다.

#### 필드
- **id** (Primary Key): 주문 고유 식별자
- **order_time** (Timestamp): 주문 일시 (기본값: 현재 시간)
- **status** (String): 주문 상태
  - `received`: 주문 접수
  - `in_production`: 제조 중
  - `completed`: 제조 완료
- **total_amount** (Integer): 주문 총 금액 (원 단위)
- **created_at** (Timestamp): 생성 일시
- **updated_at** (Timestamp): 수정 일시

#### 제약 조건
- `total_amount > 0`: 주문 총 금액은 0보다 커야 함
- `status`는 위의 세 가지 값 중 하나여야 함

### 4. OrderItems (주문 항목)

주문에 포함된 각 메뉴 항목 정보를 저장하는 테이블입니다.

#### 필드
- **id** (Primary Key): 주문 항목 고유 식별자
- **order_id** (Foreign Key): 주문 ID (Orders 테이블 참조)
- **menu_id** (Foreign Key): 메뉴 ID (Menus 테이블 참조)
- **menu_name** (String): 주문 시점의 메뉴 이름 (스냅샷)
- **quantity** (Integer): 수량
- **price** (Integer): 개별 항목 가격 (메뉴 가격 + 옵션 가격 합계)
- **created_at** (Timestamp): 생성 일시

#### 제약 조건
- `quantity > 0`: 수량은 0보다 커야 함
- `price > 0`: 가격은 0보다 커야 함
- `order_id`는 Orders 테이블의 유효한 ID여야 함
- 주문이 삭제되면 연결된 주문 항목도 함께 삭제됨 (CASCADE)

### 5. OrderItemOptions (주문 항목 옵션)

주문 항목에 선택된 옵션 정보를 저장하는 테이블입니다.

#### 필드
- **id** (Primary Key): 주문 항목 옵션 고유 식별자
- **order_item_id** (Foreign Key): 주문 항목 ID (OrderItems 테이블 참조)
- **option_id** (Foreign Key): 옵션 ID (Options 테이블 참조)
- **option_name** (String): 주문 시점의 옵션 이름 (스냅샷)
- **option_price** (Integer): 옵션 가격 (원 단위)
- **created_at** (Timestamp): 생성 일시

#### 제약 조건
- `option_price >= 0`: 옵션 가격은 0 이상이어야 함
- `order_item_id`는 OrderItems 테이블의 유효한 ID여야 함
- 주문 항목이 삭제되면 연결된 옵션도 함께 삭제됨 (CASCADE)

---

## 데이터 스키마를 위한 사용자 흐름

### 1. 메뉴 목록 조회

**흐름:**
1. 사용자가 '주문하기' 화면에 접속
2. 프론트엔드에서 `/api/menus` API를 호출
3. 백엔드에서 Menus 테이블에서 메뉴 목록을 조회
4. 각 메뉴의 연결된 Options도 함께 조회
5. 메뉴 정보를 프론트엔드에 반환 (재고 수량 포함 여부는 쿼리 파라미터로 제어)
6. 프론트엔드에서 메뉴 카드 형태로 화면에 표시

**참고:**
- 일반 사용자 화면: 재고 수량 정보는 표시하지 않음 (또는 선택적으로 표시)
- 관리자 화면: 재고 수량 정보를 표시하여 재고 관리 가능

### 2. 장바구니 구성

**흐름:**
1. 사용자가 메뉴 카드에서 옵션을 선택하고 '담기' 버튼 클릭
2. 프론트엔드에서 선택한 메뉴와 옵션 정보를 장바구니 상태에 저장
3. 장바구니에 같은 메뉴+옵션 조합이 있으면 수량 증가, 없으면 새로 추가
4. 장바구니 정보는 프론트엔드 상태로만 관리 (서버 전송 전까지)

### 3. 주문 생성

**흐름:**
1. 사용자가 장바구니에서 '주문하기' 버튼 클릭
2. 프론트엔드에서 주문 데이터 구성:
   - 각 장바구니 아이템을 OrderItems 형식으로 변환
   - 선택한 옵션을 OrderItemOptions 형식으로 변환
   - 총 금액 계산
3. 프론트엔드에서 `/api/orders` POST API를 호출하여 주문 데이터 전송
4. 백엔드에서 주문 처리:
   - Orders 테이블에 주문 정보 저장 (status: 'received')
   - OrderItems 테이블에 주문 항목 저장
   - OrderItemOptions 테이블에 옵션 정보 저장
   - 각 주문 항목의 메뉴 재고 수량 감소 (stock -= quantity)
   - 재고가 부족한 경우 에러 반환
5. 주문 성공 시 주문 ID를 반환
6. 프론트엔드에서 장바구니 초기화 및 성공 메시지 표시

**재고 관리:**
- 주문 생성 시 해당 메뉴의 재고가 자동으로 감소
- 재고가 부족한 경우 주문 실패 처리

### 4. 주문 현황 조회 및 상태 변경

**흐름:**
1. 관리자가 관리자 화면의 '주문 현황' 섹션 접근
2. 프론트엔드에서 `/api/orders` GET API를 호출
3. 백엔드에서 Orders 테이블에서 주문 목록 조회
4. 각 주문의 OrderItems와 OrderItemOptions도 함께 조회
5. 주문 목록을 최신순으로 정렬하여 반환
6. 프론트엔드에서 주문 카드 형태로 화면에 표시

**주문 상태 변경:**
1. 관리자가 주문 카드의 상태 변경 버튼 클릭 (예: '제조 시작', '제조 완료')
2. 프론트엔드에서 `/api/orders/:orderId/status` PATCH API를 호출
3. 백엔드에서 주문 상태 업데이트:
   - 상태 전이 규칙 검증 (received → in_production → completed)
   - Orders 테이블의 status 필드 업데이트
4. 업데이트된 주문 정보 반환
5. 프론트엔드에서 주문 목록 새로고침

**상태 전이 규칙:**
- `received` → `in_production`: 가능
- `in_production` → `completed`: 가능
- 역방향 전이: 불가능
- `completed`는 최종 상태 (더 이상 변경 불가)

---

## API 설계

### 1. 메뉴 목록 조회

**엔드포인트:** `GET /api/menus`

**쿼리 파라미터:**
- `includeStock` (Boolean, Optional): 재고 수량 포함 여부 (기본값: false)

**응답 예시:**
```json
{
  "menus": [
    {
      "id": 1,
      "name": "아메리카노(ICE)",
      "description": "시원하고 깔끔한 에스프레소 샷과 물",
      "price": 4000,
      "image_url": "https://example.com/image.jpg",
      "stock": 10,
      "options": [
        {
          "id": 1,
          "name": "샷 추가",
          "price": 500
        },
        {
          "id": 2,
          "name": "시럽 추가",
          "price": 0
        }
      ]
    }
  ]
}
```

**에러 응답:**
- `500 Internal Server Error`: 서버 오류

### 2. 주문 생성

**엔드포인트:** `POST /api/orders`

**요청 본문:**
```json
{
  "items": [
    {
      "menuId": 1,
      "menuName": "아메리카노(ICE)",
      "options": [
        {
          "optionId": 1,
          "optionName": "샷 추가"
        }
      ],
      "quantity": 2,
      "price": 4500
    }
  ],
  "totalAmount": 9000
}
```

**응답 예시:**
```json
{
  "order": {
    "id": 1,
    "order_time": "2024-01-15T10:30:00Z",
    "status": "received",
    "total_amount": 9000,
    "items": [
      {
        "id": 1,
        "menu_id": 1,
        "menu_name": "아메리카노(ICE)",
        "quantity": 2,
        "price": 4500,
        "options": [
          {
            "id": 1,
            "option_id": 1,
            "option_name": "샷 추가",
            "option_price": 500
          }
        ]
      }
    ]
  }
}
```

**에러 응답:**
- `400 Bad Request`: 잘못된 요청 데이터
- `404 Not Found`: 메뉴를 찾을 수 없음
- `409 Conflict`: 재고 부족
- `500 Internal Server Error`: 서버 오류

**비즈니스 로직:**
1. 요청 데이터 유효성 검증
2. 각 주문 항목의 메뉴 존재 여부 확인
3. 각 주문 항목의 재고 수량 확인 (주문 수량 <= 현재 재고)
4. 주문 생성 (트랜잭션):
   - Orders 테이블에 주문 정보 저장
   - OrderItems 테이블에 주문 항목 저장
   - OrderItemOptions 테이블에 옵션 정보 저장
   - Menus 테이블의 재고 수량 감소
5. 주문 정보 반환

### 3. 주문 목록 조회

**엔드포인트:** `GET /api/orders`

**쿼리 파라미터:**
- `status` (String, Optional): 주문 상태 필터 (received, in_production, completed)

**응답 예시:**
```json
{
  "orders": [
    {
      "id": 1,
      "order_time": "2024-01-15T10:30:00Z",
      "status": "received",
      "total_amount": 9000,
      "items": [
        {
          "id": 1,
          "menu_id": 1,
          "menu_name": "아메리카노(ICE)",
          "quantity": 2,
          "price": 4500,
          "options": [
            {
              "id": 1,
              "option_id": 1,
              "option_name": "샷 추가",
              "option_price": 500
            }
          ]
        }
      ]
    }
  ]
}
```

**에러 응답:**
- `500 Internal Server Error`: 서버 오류

### 4. 주문 상세 조회

**엔드포인트:** `GET /api/orders/:orderId`

**경로 파라미터:**
- `orderId` (Integer): 주문 ID

**응답 예시:**
```json
{
  "order": {
    "id": 1,
    "order_time": "2024-01-15T10:30:00Z",
    "status": "received",
    "total_amount": 9000,
    "items": [
      {
        "id": 1,
        "menu_id": 1,
        "menu_name": "아메리카노(ICE)",
        "quantity": 2,
        "price": 4500,
        "options": [
          {
            "id": 1,
            "option_id": 1,
            "option_name": "샷 추가",
            "option_price": 500
          }
        ]
      }
    ]
  }
}
```

**에러 응답:**
- `404 Not Found`: 주문을 찾을 수 없음
- `500 Internal Server Error`: 서버 오류

### 5. 주문 상태 변경

**엔드포인트:** `PATCH /api/orders/:orderId/status`

**경로 파라미터:**
- `orderId` (Integer): 주문 ID

**요청 본문:**
```json
{
  "status": "in_production"
}
```

**응답 예시:**
```json
{
  "order": {
    "id": 1,
    "order_time": "2024-01-15T10:30:00Z",
    "status": "in_production",
    "total_amount": 9000
  }
}
```

**에러 응답:**
- `400 Bad Request`: 잘못된 상태 전이
- `404 Not Found`: 주문을 찾을 수 없음
- `500 Internal Server Error`: 서버 오류

**비즈니스 로직:**
1. 주문 존재 여부 확인
2. 상태 전이 규칙 검증:
   - `received` → `in_production`: 가능
   - `in_production` → `completed`: 가능
   - 그 외의 전이: 불가능 (400 에러)
3. Orders 테이블의 status 필드 업데이트
4. 업데이트된 주문 정보 반환

### 6. 재고 수정

**엔드포인트:** `PATCH /api/menus/:menuId/stock`

**경로 파라미터:**
- `menuId` (Integer): 메뉴 ID

**요청 본문:**
```json
{
  "stockChange": 1
}
```

**응답 예시:**
```json
{
  "menu": {
    "id": 1,
    "name": "아메리카노(ICE)",
    "stock": 11
  }
}
```

**에러 응답:**
- `400 Bad Request`: 재고가 0 미만이 될 수 없음
- `404 Not Found`: 메뉴를 찾을 수 없음
- `500 Internal Server Error`: 서버 오류

**비즈니스 로직:**
1. 메뉴 존재 여부 확인
2. 재고 변경 후 값이 0 미만이 되는지 확인
3. Menus 테이블의 stock 필드 업데이트
4. 업데이트된 메뉴 정보 반환

### 7. 주문 통계 조회

**엔드포인트:** `GET /api/orders/stats`

**응답 예시:**
```json
{
  "stats": {
    "total": 10,
    "received": 3,
    "in_production": 2,
    "completed": 5
  }
}
```

**에러 응답:**
- `500 Internal Server Error`: 서버 오류

---

## 데이터베이스 스키마 설계

### 테이블 관계도

```
Menus (1) ──< (N) Options
  │
  │ (N)
  │
  └──< OrderItems (N) ──< (N) OrderItemOptions
        │
        │ (N)
        │
        └──< Orders (1)
```

### 인덱스 설계

- `Menus.name`: UNIQUE 인덱스
- `Orders.status`: 인덱스 (주문 상태별 조회 최적화)
- `Orders.order_time`: 인덱스 (시간순 정렬 최적화)
- `OrderItems.order_id`: 인덱스 (주문별 항목 조회 최적화)
- `Options.menu_id`: 인덱스 (메뉴별 옵션 조회 최적화)

### 트리거 설계

- `updated_at` 자동 업데이트: Menus, Options, Orders 테이블의 `updated_at` 필드가 자동으로 업데이트되도록 트리거 설정

